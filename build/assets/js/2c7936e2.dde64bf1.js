"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5486],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(n),d=r,f=p["".concat(c,".").concat(d)]||p[d]||m[d]||i;return n?o.createElement(f,a(a({ref:t},u),{},{components:n})):o.createElement(f,a({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,a=new Array(i);a[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,a[1]=s;for(var l=2;l<i;l++)a[l]=n[l];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},5089:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return l},assets:function(){return u},toc:function(){return m},default:function(){return d}});var o=n(7462),r=n(3366),i=(n(7294),n(3905)),a=["components"],s={},c="Migration",l={unversionedId:"concepts/migration",id:"concepts/migration",title:"Migration",description:"Fusio uses the Doctrine Migrations system. Fusio has basically two components which are using the migration system. At",source:"@site/docs/concepts/migration.md",sourceDirName:"concepts",slug:"/concepts/migration",permalink:"/docs/concepts/migration",editUrl:"https://github.com/apioo/fusio-docs/edit/main/docs/concepts/migration.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Middleware",permalink:"/docs/concepts/middleware"},next:{title:"Payment Provider",permalink:"/docs/concepts/payment_provider"}},u={},m=[{value:"Usage",id:"usage",level:2},{value:"Commands",id:"commands",level:2}],p={toc:m};function d(e){var t=e.components,n=(0,r.Z)(e,a);return(0,i.kt)("wrapper",(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"migration"},"Migration"),(0,i.kt)("p",null,"Fusio uses the Doctrine Migrations system. Fusio has basically two components which are using the migration system. At\nfirst Fusio it self uses it to install the internal schema and execute updates on a new release. Then it is also\npossible for the API developer to use the migration system on any remote SQL connection."),(0,i.kt)("h2",{id:"usage"},"Usage"),(0,i.kt)("p",null,"For example to install Fusio you execute the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"php /bin/fusio migration:migrate\n")),(0,i.kt)("p",null,"which then executes all migrations on the database which was configured at the ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file. You may have also executed\nthe ",(0,i.kt)("inlineCode",{parentName:"p"},"install")," command but this is simply an alias to the ",(0,i.kt)("inlineCode",{parentName:"p"},"migrate")," command."),(0,i.kt)("p",null,"To use the migration in your app you can provide a connection option which tells Fusio which connection should be used.\nThis can be any SQL connection which you have configured at Fusio."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"php /bin/fusio migration:migrate --connection=System\n")),(0,i.kt)("p",null,"Fusio will look into the ",(0,i.kt)("inlineCode",{parentName:"p"},"src/Migrations/"),' folder and search for a folder which has the name of your connection. In this\ncase it would be "System". Then it will execute all migrations which are not already executed.'),(0,i.kt)("h2",{id:"commands"},"Commands"),(0,i.kt)("p",null,"Fusio supports the following migration commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"migration:execute     Execute a single migration version up or down manually.\nmigration:generate    Generate a blank migration class.\nmigration:latest      Outputs the latest version number\nmigration:migrate     [install] Execute a migration to a specified version or the latest available version.\nmigration:status      View the status of a set of migrations.\nmigration:up-to-date  Tells you if your schema is up-to-date.\nmigration:version     Manually add and delete migration versions from the version table.\n")))}d.isMDXComponent=!0}}]);